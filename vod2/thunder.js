function BigThunder(){this.$();}BigThunder.prototype={$:function(){if(typeof(this._o)=='undefined')try{BigThunder.prototype._o=new ActiveXObject("ThunderAgent.Agent");}catch(e){try{BigThunder.prototype._o=new ActiveXObject("ThunderAgent.Agent.1");}catch(e){BigThunder.prototype._o=null;}}return this._o;},_af:-1,_afs:[function(t,c,u,r,n,s){t.AddTask5(u,n,"",n,r,-1,0,4,"",c,s,1,"",-1)},function(t,c,u,r,n,s){t.AddTask4(u,"","",n,r,-1,0,-1,"userid="+getCookie('urserid'),c,s)},function(t,c,u,r,n,s){t.AddTask3(u,"","",n,r,-1,0,-1,"",c)},function(t,c,u,r,n,s){t.AddTask2(u,"","",n,r,-1,0,-1,"")},function(t,c,u,r,n,s){t.AddTask(u,"","",n,r,-1,0,-1)}],_add:function(cid,url,refer,name,stat){if(this._af>=0){this._afs[this._af](this._o,cid,url,refer,name,stat);return true;}for(var i=0;i<this._afs.length;++i)try{this._afs[i](this._o,cid,url,refer,name,stat);this._af=i;return true;}catch(e){}return false;},_cf:-1,_cfs:[function(t){t.CommitTasks2(1);},function(t){t.CommitTasks();}],_commit:function(){if(this._cf>=0){this._cfs[this._cf](this._o);return true;}for(var i=0;i<this._cfs.length;++i)try{this._cfs[i](this._o);this._cf=i;return true;}catch(e){}return false;},down:function(cid,url,refer,name,stat){if(!(this._add(cid,url,refer,name,stat)&&this._commit()))throw'不支持此方法，请安装最新的迅雷客户端';},batch:function(res){for(var i=0;i<res.length;++i){var o=res[i];if(!this._add(o.cid,o.url,o.refer,o.name,o.stat))return false;}return this._commit();}};function WebThunder(){this.$();}WebThunder.prototype={$:function(){if(typeof(this._o)=='undefined')try{WebThunder.prototype._o=new ActiveXObject("ThunderServer.webThunder.1");}catch(e){WebThunder.prototype._o=null;}return this._o;},_whd:function(s){return s.replace(/<br>/g,"\n").replace(/&lt/g,"<").replace(/&gt/g,">").replace(/&quot/g,"\"").replace(/&apos/g,"\'").replace(/&amp/g,"&");},down:function(cid,url,refer,name,stat){this._o.CallAddTask(this._whd(url),name,this._whd(refer),1,cid,stat);},batch:function(res){var s=this._o.BeginBatchTask();for(var i=0;i<res.length;++i){var o=res[i];this._o.AddTaskToBatch(s,o.url,o.name,o.refer,o.cid,o.stat);}this._o.EndBatchTask(s);}};function Thunder(web_first,only){this.$(web_first,only);}Thunder.prototype={$:function(web_first,only){if(typeof(this._$)=='undefined'){this.web_first=web_first;this.only=typeof(only)=='undefined'?false:only;this._o=web_first?new WebThunder():new BigThunder();if(this._o.$())this._$=true;else if(only)this._$=false;else{this._o=web_first?new BigThunder():new WebThunder();this._$=this._o.$()?true:false;}}return this._$;},down:function(cid,url,ref,nam,sta){if(!this._$)return true;this._o.down(cid,url,ref,nam,sta);return false;},batch:function(res){if(!this._$)return true;this._o.batch(res);return false;}};